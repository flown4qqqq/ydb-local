# ALTER USER

Изменяет пользователя базы данных.

Синтаксис:

```yql
ALTER USER user_name [ WITH ] option [ ... ]
```

* `user_name` — имя пользователя.
* `option` — опция команды:
  * `PASSWORD 'password'` — изменяет пароль на `password`; нельзя использовать одновременно с `HASH`.
  * `PASSWORD NULL` — устанавливает пустой пароль; нельзя использовать одновременно с `HASH`.
  * `HASH 'hash'` — задает пользователю пароль, хеш которого содержится в [JSON-структуре](#hash-link) `'hash'`; нельзя использовать одновременно с `PASSWORD`.
  * `NOLOGIN` — запрет на [вход](../../../security/authentication.md) пользователя в систему; нельзя использовать одновременно с `LOGIN`.
  * `LOGIN` — разрешение на [вход](../../../security/authentication.md) пользователя в систему; нельзя использовать одновременно с `NOLOGIN`.

{% include [!](../../../_includes/do-not-create-users-in-ldap.md) %}

## PASSWORD

Администратор базы данных может изменить или снять пароль пользователя. Пароль должен задаваться в кавычках, если только не используется опция `PASSWORD NULL`.

{% note info %}

Пользователь может поменять свой пароль, даже если он не обладает правами администратора.

{% endnote %}

Примеры:

```yql
ALTER USER user1 PASSWORD 'password';
```

```yql
ALTER USER user1 PASSWORD NULL;
```


## HASH {#hash-link}

В {{ ydb-short-name }} пароль пользователя хранится в хешированном неизменном виде. Поэтому, чтобы была возможность восстановить пользователя с тем же паролем при бэкапе базы данных, существует опция `HASH`, которая позволяет изменить пароль пользователя после его создания, зная только хеш в формате JSON. В этом JSON-объекте хранится дайджест хеш функции и название алгоритма (на данный момент используется [argon2id](https://ru.wikipedia.org/wiki/Argon2)).

Параметр `'hash'` должен принимать JSON-объект, в котором есть ровно три поля:

* `hash` - значение самого хеша в формате base64;
* `salt` - [соль](https://ru.wikipedia.org/wiki/Соль_(криптография)) в формате base64;
* `type` - алгоритм, которым был хеширован пароль; это значение должно быть всегда равно `argon2id`.


Пример:

```yql
ALTER USER user1 HASH '{
    "hash": "p4ffeMugohqyBwyckYCK1TjJfz3LIHbKiGL+t+oEhzw=",
    "salt": "U+tzBtgo06EBQCjlARA6Jg==",
    "type": "argon2id"
}';
```

## NOLOGIN

Администратор базы данных может заблокировать пользователя. Блокировка пользователя означает, что в системе устанавливается запрет на вход пользователя в систему.

Пример:

```yql
ALTER USER user1 NOLOGIN;
```

## LOGIN

При превышении ограничения на количество попыток аутентификации пользователь временно блокируется. Администратор базы данных может снять блокировку досрочно, используя опцию `LOGIN`.

Кроме того, пользователь может быть заблокирован опцией `NOLOGIN`. В этом случае администратор базы данных так же может снять блокировку с помощью `LOGIN`.

Пример:

```yql
ALTER USER user1 LOGIN;
```

## Встроенные пользователи

{% include [!](../_includes/initial_groups_and_users.md) %}
